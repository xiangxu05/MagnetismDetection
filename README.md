# MagnetismDetection
一个集成了弱磁检测与GPS定位设备的上位机软件，使用了设备与上位机之间使用TCP通讯，设备间AP组网。

<p align="center">软件界面</p>  

![软件界面](https://github.com/xiangxu05/MagnetismDetection/assets/112842118/4646c6c6-fa73-43be-930c-a0469e3f5e19)  

<p align="center">设备图片（单探头）</p>  

![设备图片](https://github.com/xiangxu05/MagnetismDetection/assets/112842118/7e105e3f-196c-4009-a1f9-4c5ea900d04f)


## 操作流程
- 首先连接设备WIFI：Magnetism_main；  
- 填写设备IP地址（主设备、从设备）；  
- 点击连接按钮；  
- 勾选保存数据到文件复选框，选择保存路径；  
- 连接成功后，点击开始推断；  
备注：默认IP地址已填入，若IP地址改动，可以分别接入Magenetism_main与slave两个WIFI查看，其中slave设备由于连接入main设备主网，应该登陆其网关查看连接后的对应地址。

## 设备组网
- 连接主设备WIFI，访问局域网网关，设置设备为AP模式，建议打开DHCP，防止上位机难以连接入网络，建议更改主设备WIFI名称，方便后续连接区分；  
- 连接从设备WIFI，访问局域网网关，设置设备为APSTA模式，其中STA模式中关闭DHCP，自行分配与主设备同一网段IP，以便于后续访问，建议更改从设备WIFI名称，方便后续连接区分；  
- 从设备设置连接主设备WIFI，备注：主从设备保存参数后请重启；  
- 重新连接主设备WIFI，根据设置IP填入软件中；  
- 点击连接。  

## RTK配置
请拆开设备外壳，使用备用j30j9p线与GPS设备连接，并进行供电。  
备注：需提前安装CP210X驱动。  
- 使用上位机软件FDIGroudbase进行配置，首先在菜单栏中选择添加串口，波特率为921600。
- 在config界面中，找到DGNSS选项
- 选择配置参数：Ntrip，填入域名/ip、端口号、挂载点、账号与密码
- 点击send 按钮进行保存，再点击reflash按钮检验是否保存成功；接着点击config 界面左下角的transmit ->write flash按钮保存到flash，最后点击restart按钮重启，账号仅需配置一次即可。


#更新日志
=========================================================
"---------------- V1.1 ----------------\n"  
"2024年3月26日 -------- 对GPS精度进行了修正\n"  
"2024年3月26日 -------- 增加了GPS设备定位状态\n"  
"---------------- V1.11 ----------------\n"  
"2024年3月26日 -------- 删除了时间显示的毫秒部分\n"  
"2024年3月26日 -------- 解决了开始监测时首次读取数据为0的异常状态\n"  
"2024年3月26日 -------- 实验证明外壳影响信号，AP性能与信号强度也不足 下一阶段需要解决设备传输信号与丢包问题\n"  
"---------------- V1.12 ----------------\n"  
"2024年4月1日   -------- 增加了帮助菜单\n"  
"2024年4月1日   -------- 缩小了界面\n"  
"2024年4月1日   -------- 修复了取消勾选传感器三个轴时，曲线仍存在的问题\n"  
"2024年4月1日   -------- 修复了折线纵轴取值不准确，与X轴值相关的问题\n"  
"---------------- V1.13 ----------------\n"  
"2024年4月22日   -------- 适配购置的pad设备。");  
